{% if shipping_rules %}
<fieldset class="shipping-methods-list">
	<legend><h6>{{ _("Choose a shipping method") }}</h6></legend>

	{% set current_shipping_method = doc.shipping_rule or "" %}

	{% for method in shipping_rules %}
	{% set name = method.name %}
	{% set input_id = "shipping_method_" ~ name |e %}
	{% set estimated_cost = shipping_estimates.get(name) if shipping_estimates else "" %}
	{% set label = method.label or _("None") %}

	<label for="{{ input_id }}">
		<input
			type="radio"
			name="shipping"
			id="{{ input_id }}"
			value="{{ name |e }}"
			{% if name == current_shipping_method %}checked{% endif %}
		/>

		<span class="estimated-cost">{{ estimated_cost |e }}</span>

		{{ label |e }}

		{% if method.description %}
			<div class="description">{{ method.description }}</div>
		{% endif %}
	</label>
	{% endfor %}
</fieldset>

<script>
document.addEventListener("DOMContentLoaded", () => {
	frappe.provide("erpnext.e_commerce.shopping_cart");
	const shopping_cart = erpnext.e_commerce.shopping_cart;

	$(".cart-container").on("change", ".shipping-methods-list input[name=shipping]", (e) => {
		const shipping_method = e.target.value;
		shopping_cart.apply_shipping_rule(shipping_method);
	});
});
</script>
{% endif %}
